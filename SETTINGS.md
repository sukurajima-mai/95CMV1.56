# 设置说明

## 概述

GUI版本提供了完整的设置功能，可以方便地调整检测参数和传送设置。

## 界面布局

GUI采用左右分栏布局：
- **左栏**：主要功能、依赖管理、运行日志
- **右栏**：设置面板、检测范围预览

## 设置选项

### 检测设置

#### 1. 检测关键词
- **说明**：要检测的目标文字
- **默认值**：人物斩杀
- **修改方法**：在输入框中输入新的关键词
- **生效方式**：点击"应用设置"后立即生效（需要重启挂机脚本）

#### 2. 传送按键
- **说明**：使用传送石的快捷键
- **默认值**：2
- **可选值**：任何键盘按键（如：'2', 'F4', 'Space'等）
- **修改方法**：在输入框中输入按键名称
- **生效方式**：点击"应用设置"后立即生效

#### 3. 检测间隔
- **说明**：每次检测之间的时间间隔（秒）
- **默认值**：0.3秒
- **范围**：0.1 - 5.0秒
- **建议**：0.3-0.5秒（太短会占用过多CPU，太长会降低响应速度）
- **生效方式**：点击"应用设置"后立即生效（需要重启挂机脚本）

#### 4. 传送冷却
- **说明**：使用传送石后的冷却时间（秒）
- **默认值**：4秒
- **范围**：1.0 - 60.0秒
- **建议**：4-10秒（避免频繁传送被封号）
- **生效方式**：点击"应用设置"后立即生效

### 检测范围

检测范围用于指定在屏幕的哪个区域进行文字识别。

#### 1. 上边界
- **说明**：检测范围的上边界（屏幕高度的百分比）
- **默认值**：20%
- **范围**：0 - 100%
- **说明**：0%表示屏幕顶部，100%表示屏幕底部
- **调整方法**：使用Spinbox调整，每次调整会自动更新预览

#### 2. 下边界
- **说明**：检测范围的下边界（屏幕高度的百分比）
- **默认值**：60%
- **范围**：0 - 100%
- **说明**：20%-60%表示检测屏幕中间区域
- **调整方法**：使用Spinbox调整，每次调整会自动更新预览

#### 3. 左边界
- **说明**：检测范围的左边界（屏幕宽度的百分比）
- **默认值**：5%
- **范围**：0 - 100%
- **说明**：用于避开左侧UI界面
- **调整方法**：使用Spinbox调整，每次调整会自动更新预览

#### 4. 右边界
- **说明**：检测范围的右边界（屏幕宽度的百分比）
- **默认值**：95%
- **范围**：0 - 100%
- **说明**：用于避开右侧地图界面
- **调整方法**：使用Spinbox调整，每次调整会自动更新预览

### 调试模式

- **说明**：启用后会保存调试图片到debug文件夹
- **默认值**：启用
- **作用**：
  - 保存完整截图
  - 保存检测区域截图
  - 保存检测结果（带标注）
- **建议**：调试时启用，正常运行时可以关闭以节省磁盘空间

## 检测范围预览

### 功能
实时显示检测范围在屏幕上的位置。

### 使用方法
1. 点击"测试截图"按钮截取游戏窗口
2. 调整检测范围的上下左右边界
3. 预览区域会自动更新，显示黄色矩形框表示检测范围

### 可视化说明
- **黄色半透明区域**：检测范围
- **黄色边框**：检测范围边界
- **文字标注**：显示检测范围的像素坐标

## 应用设置

### 操作步骤
1. 修改各项设置
2. 点击"应用设置"按钮
3. 设置会保存到配置文件

### 生效说明
- **立即生效**：传送按键、传送冷却
- **需要重启**：检测关键词、检测间隔、检测范围

### 配置文件
设置会保存到 `bot_config.ini` 文件中，下次启动时会自动加载。

## 使用建议

### 1. 首次使用
1. 点击"测试窗口检测"确认能找到游戏窗口
2. 点击"测试截图"截取游戏窗口
3. 调整检测范围，确保目标文字在检测范围内
4. 点击"应用设置"保存配置
5. 点击"启动"开始挂机

### 2. 调整检测范围
如果检测不到目标文字：
1. 点击"测试截图"
2. 查看debug文件夹中的截图
3. 调整检测范围的上下左右边界
4. 查看预览区域，确认检测范围正确
5. 点击"应用设置"
6. 重新启动挂机脚本

### 3. 修改检测关键词
如果要检测其他文字：
1. 在"检测关键词"输入框中输入新的关键词
2. 点击"应用设置"
3. 停止当前运行的挂机脚本
4. 重新启动挂机脚本

### 4. 修改传送按键
如果要使用其他按键：
1. 在"传送按键"输入框中输入新的按键名称
2. 点击"应用设置"
3. 确保游戏内已将传送石绑定到该按键
4. 测试按键是否正常工作

## 常见问题

### 1. 设置修改后不生效
- **原因**：部分设置需要重启挂机脚本才能生效
- **解决**：停止挂机脚本，重新启动

### 2. 检测范围预览不显示
- **原因**：还没有截取游戏窗口
- **解决**：点击"测试截图"按钮

### 3. 检测范围调整后预览不更新
- **原因**：Spinbox的command参数可能不工作
- **解决**：调整后点击"应用设置"，预览会自动更新

### 4. 检测不到目标文字
- **可能原因**：
  - 检测范围不正确
  - 目标文字不在检测范围内
  - OCR识别率太低
- **解决方法**：
  1. 点击"测试截图"
  2. 查看debug文件夹中的截图
  3. 调整检测范围
  4. 运行OCR测试脚本查看识别结果

### 5. 传送按键没有反应
- **可能原因**：
  - 按键名称不正确
  - 游戏内未绑定传送石
  - 游戏窗口未激活
- **解决方法**：
  1. 确认按键名称正确（如：'2', 'F4'）
  2. 确认游戏内已将传送石绑定到该按键
  3. 确认游戏窗口在前台

## 技术说明

### 检测范围计算
```
top_y = height * top_percent / 100
bottom_y = height * bottom_percent / 100
left_x = width * left_percent / 100
right_x = width * right_percent / 100
```

### 配置文件格式
```ini
[Detection]
enabled = true
detection_interval = 0.3
debug = true

[Teleport]
enabled = true
teleport_key = 2
cooldown = 4

[Advanced]
use_opencv = true
detection_top_percent = 20
detection_bottom_percent = 60
detection_left_percent = 5
detection_right_percent = 95
```

### 自动清理
- 退出GUI时会自动清空debug文件夹中的所有jpg文件
- 避免debug文件夹占用过多磁盘空间

## 更新日志

### v3.3 - 设置功能 (2026-02-13)

**新增功能**：
- ✅ 完整的设置面板
- ✅ 检测关键词修改
- ✅ 传送按键修改
- ✅ 检测间隔调整
- ✅ 传送冷却调整
- ✅ 检测范围调整（上下左右）
- ✅ 检测范围可视化预览
- ✅ 调试模式开关
- ✅ 退出时自动清空debug文件夹

**界面改进**：
- 左右分栏布局
- 设置面板独立显示
- 检测范围实时预览
- 界面尺寸调整（1100x800）

**文件新增**：
- `SETTINGS.md` - 本文档
